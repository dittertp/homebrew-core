trigger:
- master

strategy:
  matrix:
    mojave:
      imageName: 'macOS-10.14'
    highsierra:
      imageName: 'macOS-10.13'

pool:
  vmImage: $(imageName)

steps:

- script: |
    git show --pretty="" --name-only HEAD
  displayName: "Test git"

- script: |
    pip install --upgrade pip
    pip install -Iq -r requirements.txt
  workingDirectory: .github/ansible
  displayName: 'Install dependencies'

- script: |
    ansible-playbook playbooks/build-bottles.yml
  workingDirectory: .github/ansible
  displayName: 'Build bottles'

- script: |
    ls -lsa
    ls -lsa build
  displayName: 'Test'
